<!DOCTYPE html>
{% extends "base.html" %}
{% load static %}
<html>
{% block content %}
<head>
	<title>{{item.item_name}}</title>
</head>
<body>
<div style="padding-left: 15px">
  <h1>{{ item.item_name }}{% if request.user.is_staff or request.user.is_superuser %}
        <small><a href="{% url 'modify_an_item' item_id=item.id%}" style="margin-right:15px"><span title="Modify" style="margin-left:15px; color:green" class="glyphicon glyphicon-edit" aria-hidden="true"> </span></a>
        {% if request.user.is_superuser %}
          <a href="{% url 'delete check' item_id=item.id %}" ><span title="Delete" style="margin-left:5px; color:red" class="glyphicon glyphicon-remove" aria-hidden="true"> </span></a>
        {% endif %}</small>{% endif %}</h1>
  <p>Available: {{item.count}}</p>
  {% if request.user.is_staff %}
  <p>Minimum Stock Threshold: {{item.minimum_stock}} {% if item.understocked %}<span style="color: red">(Understocked)</span>{% endif %}</p>
  {% endif %}
  <p>Model: {{item.model_number}}</p>
  <p>Description: {{item.description}}</p>
</div>
<div style="padding-left: 15px">
  <!--Custom Fields-->
  {% for cf in custom %}
    <p>{{cf}}</p>
  {% endfor %}
</div>
<div style="padding-left: 15px">
  <h2>Tags</h2>
  {% for tag in tags %}
    <span class="badge">{{tag}}</span>
  {% endfor %}
  {% if tags|length == 0 %}
  <p>None</p>
  {% endif %}
</div>

{% if requests|length > 0 %}
<h2 style="padding-left: 15px">Requests with this item</h2>
{% endif %}
<ul class="list-group">
	{% for request in requests %}
  	<li class="list-group-item list-group-item-action flex-column align-items-start">
    <div class="d-flex w-100 justify-content-between">
    {% if request.status == 'O' %}
    {% if user.is_staff %} 
      <big>Owner:</big> {{request.owner}}
    {% endif %}
    <big style="padding-left: 12px">Reason:</big> 
    {% if user.is_staff %}
    <a href="{% url 'cart request details' request.parent_cart.id %}">
    {% else %}
    <a href="{% url 'view request details' request.parent_cart.id %}"> 
    {% endif %}
    {{request.reason}}</a> <span style="margin-left:10px; margin-right:20px" class="badge">{{request.quantity}}</span>
    <big>Requested</big></div></li> 

    {% elif request.status == 'L' or request.status == 'B'%}
    {% if user.is_staff %} 
      <big>Owner:</big> {{request.owner}}
    {% endif %}
    <big style="padding-left: 12px">Reason:</big> 
    {% if user.is_staff %}
    <a href="{% url 'cart request details' request.parent_cart.id %}">
    {% else %}
    <a href="{% url 'view request details' request.parent_cart.id %}"> 
    {% endif %}
    {{request.reason}}</a> <span style="margin-left:10px; margin-right:20px" class="badge">{{request.quantity}}</span><big>{{request.get_status_display}}</big></div></li> 
    {% endif %}
	{% endfor %}
</ul>

{% if not user.is_anonymous %}
<h1 style="padding-left: 15px">Add Item to Cart: </h1>
<div>
<form class="navbar-form navbar-top" role="search" action="{% url 'request' item.id %}" method="POST">	
  {% csrf_token %}
  <div class="form-group">
    <label for="quantity">Quantity:</label>
    <input id="quantity" name="quantity" type="number" required step="1" min="1" class="form-control">
  </div>
  <button id="save_request" type="submit" class="btn btn-default">Add to Cart</button>
</form>
</div>
{% endif %}
{% endblock %}
</body>
</html>
